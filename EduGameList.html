<!--		SVG animation example	http://taye.me/blog/svg/a-guide-to-svg-use-elements/		-->
<head>
	<title>Educational Games</title>
	<link rel="icon" href="SGLogo.png">
	<link rel="shortcut icon" href="SGLogo.png">
</head>

<script type="text/javascript" src="SmoothScrolling.js"></script>
<script type="text/javascript" src="EduGameListJs/GameList.js"></script>
<script type="text/javascript" src="EduGameListJs/ListSort.js"></script>

<style>
	@font-face {
		font-family: OpenDyslexicAlta;
		font-weight: bold;
		src: url("open_dyslexic/OpenDyslexicAlta-Bold.otf") format("opentype");
	}

	svg {
		font-family: "OpenDyslexicAlta", "Arial";
		background-color: #23d9b0;
		padding: 0;
	}

	.button {
		transition: 0.2s;
		cursor: pointer;
		fill-opacity: 0;
	}

		.button:hover {
			fill-opacity: 0.2;
		}

	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
<body>
	<svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1600 10000" id="svgViewBox">
		<!--		Top Banner		-->
		<g transform="translate(0 0)">
			<rect x="-900" width="3e3" height="80" fill="#20a080" style="paint-order:normal" />
			<text x="796" y="60" font-weight="bold" stroke-width="1.5" text-anchor="middle" font-size="52px">
				Syllabus Games
			</text>
			<path d="m173 4-43 71h420l43-71z" fill="none" stroke="#5cc0a8" stroke-width="3.7795" />
			<text x="360" y="37" font-weight="bold" stroke-width="1.5" text-anchor="middle" font-size="40px" fill="#D0D0D0">
				Educational
			</text>
			<text x="344" y="70" font-weight="bold" stroke-width="1.5" text-anchor="middle" font-size="40px" fill="#D0D0D0">
				Games List
			</text>
			<path d="m1415 4 43 71h-420l-43-71z" fill="none" stroke="#5cc0a8" stroke-width="3.7795" />
			<text x="1210" y="37" font-weight="bold" stroke-width="1.5" text-anchor="middle" font-size="40px">
				Works In Progress
			</text>
			<text x="1232" y="70" font-weight="bold" stroke-width="1.5" text-anchor="middle" font-size="40px">
				and other projects
			</text>


			<!--		Clickable Paths		-->
			<a xlink:href="EduGameList.html" target="_parent">
				<path d="m173 4-43 71h420l43-71z" class="button" /><!--	EDU List		-->
			</a>

			<a xlink:href="index.html" target="_parent">
				<path d="m593 4h403l43 71h-490l43-71" class="button" /><!--	index		-->
			</a>

			<a xlink:href="WIP.html" target="_parent">
				<path d="m1415 4 43 71h-420l-43-71z" class="button" /><!--	WIP Page		-->
			</a>
		</g>

		<g id="listHeader" class="txt" font-size="18" transform="translate(12 100)">
			<path d="m1564 40v-22s0-12-12-12h-1542c-10 0-10 10-10 10v24h1565" stroke="#5cc0a8" stroke-width="3" fill="#00FFFF" />
			<text y="28" x="6">Type</text>
			<rect height="26" width="55" y="10" x="4" fill-opacity="0" class="button" onclick="sortProperty(0);" />
			<text y="28" x="80">Subject</text>
			<rect height="26" width="150" y="10" x="68" fill-opacity="0" class="button" onclick="sortProperty(1);" />
			<text y="28" x="230">Play It?</text>
			<rect height="26" width="80" y="10" x="228" fill-opacity="0" class="button" onclick="sortProperty(2);" />
			<text y="28" x="330">Subject (Specific)</text>
			<rect height="26" width="590" y="10" x="328" fill-opacity="0" class="button" onclick="sortProperty(1);" /><!--	Yes, clicking this sorts by Subject	-->
			<text y="28" x="930">Title</text>
			<rect height="26" width="350" y="10" x="928" fill-opacity="0" class="button" onclick="sortProperty(4);" />
			<text y="28" x="1290">Grade</text>
			<rect height="26" width="65" y="10" x="1288" fill-opacity="0" class="button" onclick="sortProperty(5);" />
			<text y="28" x="1360">Time</text>
			<rect height="26" width="75" y="10" x="1358" fill-opacity="0" class="button" onclick="sortProperty(6);" />
			<text y="28" x="1440">Price</text>
			<rect height="26" width="55" y="10" x="1438" fill-opacity="0" class="button" onclick="sortProperty(7);" />
			<text y="28" x="1500">Form</text>
			<rect height="26" width="55" y="10" x="1498" fill-opacity="0" class="button" onclick="sortProperty(8);" />
		</g>
		<g id="gameList"></g><!--		This is the group all game list entries are added to		-->
	</svg>

	<script>

		var xmlns = "http://www.w3.org/2000/svg";
		var xlinkns = "http://www.w3.org/1999/xlink";

		var pos = 140;
		var t = performance.now();//		record to see total load time for this page
		var k = 0;
		var svg = document.getElementsByTagName('svg')[0];
		var header;
		var screenShot;

		//	HVS V=0.781 S=0.914		H=0.45	H=0.48		H=0.51		H=0.42
		var backgroundColors = ['#33E9B2', '#33E9D3', '#33DEE9'];

	//	----------------------------------		[   ReSort List   ]		----------------------------------
		function sortProperty(typ){//		called from SVG buttons above
			if (sortVar[0] == typ) {//		double clicked the sort button
				list.reverse();
				listUpdate();
				return;
			}
			//		shift every sort property down one and assign the new one as the primary sort variable
			sortVar[2] = sortVar[1];
			sortVar[1] = sortVar[0];
			sortVar[0] = typ;
			list.sort(sortList);
			listUpdate();
		}

		var sortVar = [1, 2, 0];//	sort by subject, then rating, then type

	//	----------------------------------		[   Sort list called   ]		----------------------------------
		list.sort(sortList);//		see GameList.js and ListSort.js


		var gameList = document.getElementById("gameList");

	//	----------------------------------		[   Create SVG List Elements   ]		----------------------------------
		for (i = 0; i < list.length; i++){
			var entry = document.createElementNS(xmlns, "g");
			gameList.appendChild(entry);
			//		create each entry in the game list as an SVG
			entry.innerHTML = '<rect height = "40" width = "1564" stroke = "#5cc0a8" id='+i.toString()+' stroke-width="3" fill="' + backgroundColors[i%3] + '"/>\
				<path d="m1495 10v23m-60-23v23m-80-23v23m-60-23v23m-370-23v23m-610-23v23m-90-23v23m-170-23v23" stroke="#5cc0a8" stroke-width="3"/>\
				<text y="28" x="6" font-size="18">' + list[i][0] + '</text>\
				<text y="28" x="60" font-size="18">' + list[i][1] + '</text>\
				<text y="28" x="230" font-size="18">' + list[i][2] + '</text>\
				<text y="28" x="320" font-size="18">' + list[i][3] + '</text>\
				<text y="28" x="930" font-size="18">' + list[i][4] + '</text>\
				<text y="28" x="1300" font-size="18">' + list[i][5] + '</text>\
				<text y="28" x="1360" font-size="18">' + list[i][6] + '</text>\
				<text y="28" x="1440" font-size="18">' + list[i][7] + '</text>\
				<text y="28" x="1500" font-size="18">' + list[i][8] + '</text>\
				<a xlink: href="' + list[i][10] + '" target="_parent">\
					<rect height="25" width="360" y="9" x="928" fill-opacity="0" class="button" onmouseover="imageUpdate(\'' + list[i][9] + '\');" onmouseout="imageUpdate(\'\');"></rect>\
				</a>';
			entry.setAttribute("transform", 'translate(12 '+pos.toString()+')');

			list[i][12] = entry;//	store the visual element for each game in that game's list entry

			if (i != list.length - 1 && list[i][11] != list[i + 1][11]) {//		this line is sorted into the same group as the last line
				pos += 80;
				//		add catigory header here
			} else {
				pos += 40;
			}
		}
		console.log("Loaded list in\n" + Math.round(performance.now() - t).toString() + "ms");

	//	----------------------------------		[   Set Up Image   ]		----------------------------------
		screenShot = document.createElement("img");
		screenShot.setAttribute('style', 'opacity: 0.85;position: absolute;left: 50%; top: 100;margin-left: -300px;pointer-events: none; display: none');
		screenShot.setAttribute("width", "600");
		document.body.appendChild(screenShot);

		console.log("Loaded page in\n" + Math.round(performance.now() - t).toString() + "ms");


	//	----------------------------------		[   Update list after re-sort   ]		----------------------------------
		function listUpdate(){//		move all elements to their new positions in list
			t = performance.now();

			pos = 140;
			for (i = 0; i < list.length; i++) {
				list[i][12].setAttribute("transform", 'translate(12 ' + pos.toString() + ')');
				list[i][12].children[0].setAttribute('fill', backgroundColors[i % 3]);

				if (i != list.length-1 && list[i][11] != list[i + 1][11]) {//		this line is sorted into the same group as the last line
					pos += 80;
					//		add catigory header here
				} else {
					pos += 40;
				}
			}

			console.log("Reloaded list in\n" + Math.round(performance.now() - t).toString() + "ms");
		}


	//	----------------------------------		[   Update Image   ]		----------------------------------
		function imageUpdate(imageLink){
			if (imageLink == "") {
				fadeIn = false;
			} else if (window.innerWidth > 600) {//		screen is wide enough that images will not fill the whole page
				fadeIn = true;
				screenShot.style.display = "block";
				screenShot.style.top = Math.max(window.pageYOffset + 10, 100);
				screenShot.setAttribute("src", "GameListImages/" + imageLink + ".png");
				//		wait for image to load
				/*
				function waitForImageToLoad(imageElement) {
					return new Promise(resolve => { imageElement.onload = resolve })
				}

				var myImage = document.getElementById('myImage');
				var newImageSrc = "https://pmchollywoodlife.files.wordpress.com/2011/12/justin-bieber-bio-photo1.jpg?w=620"

				myImage.src = newImageSrc;
				waitForImageToLoad(myImage).then(() => {
					// Image have loaded.
					console.log('Loaded lol')
				});*/

			}
			if (!fading) {//		if imageFade() is not already running
				fading = true;
				imageFade();
			}
		}


		//	----------------------------------		[   Image Transition Animation   ]		----------------------------------
		var fadeIn = true;
		var fading = false;
		var fadeValue = 0.1;

		function imageFade(){
			//		shift fade value in direction set in imageUpdate()
			if (fadeIn) {
				fadeValue += 0.07;
			} else {
				fadeValue -= 0.05;
			}
			//		if fade ends, stop this function from being called again and set the final value to exactly what it should be.
			if (fadeValue > 0.93) {
				fadeValue = 0.93;//		set to 1 so there are 2 frames where the cursor is off the selection but the image has not started fading yet
				fading = false;
			} else if (fadeValue < 0) {
				fadeValue = 0;
				screenShot.style.display = "none";//		hide image
				fading = false;
			}
			screenShot.style.opacity = Math.min(fadeValue, 0.85);
			if (fading)//		fade has not reached its final value so call this function again next frame
				requestAnimationFrame(imageFade);
		}

	</script>
</body>